<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Player HLS com Legendas Dinâmico</title>
    <!-- Importar CSS do Video.js -->
    <link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet" />
</head>
<body>
    <!-- Container onde o player será inserido -->
    <div id="player-container"></div>

    <!-- Importar Video.js -->
    <script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>
    <script>
        // Função para extrair parâmetros da URL
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        // Obter URLs dos parâmetros
        const hlsUrl = getQueryParam('hls');
        const vttUrl = getQueryParam('vtt');

        // Função para gerar o player dinamicamente
        function createPlayer() {
            if (!hlsUrl) {
                document.getElementById('player-container').innerHTML = 
                    '<p>Erro: Parâmetro HLS não fornecido na URL.</p>';
                return;
            }

            // Criar elemento de vídeo
            const videoElement = document.createElement('video');
            videoElement.id = 'my-video';
            videoElement.className = 'video-js vjs-default-skin';
            videoElement.setAttribute('controls', '');
            videoElement.setAttribute('preload', 'auto');
            videoElement.setAttribute('width', '640');
            videoElement.setAttribute('height', '360');

            // Adicionar fonte HLS
            const sourceElement = document.createElement('source');
            sourceElement.src = hlsUrl;
            sourceElement.type = 'application/x-mpegURL';
            videoElement.appendChild(sourceElement);

            // Adicionar legenda VTT, se fornecida
            if (vttUrl) {
                const trackElement = document.createElement('track');
                trackElement.kind = 'subtitles';
                trackElement.src = vttUrl;
                trackElement.srclang = 'pt';
                trackElement.label = 'Português';
                trackElement.default = true;
                videoElement.appendChild(trackElement);
            }

            // Inserir vídeo no container
            document.getElementById('player-container').appendChild(videoElement);

            // Inicializar Video.js
            const player = videojs('my-video', {}, function() {
                console.log('Player inicializado');
                // Verificar erros de carregamento
                this.on('error', function() {
                    console.error('Erro no player:', this.error());
                });
            });
        }

        // Executar quando a página carregar
        window.onload = createPlayer;
    </script>
</body>
</html>